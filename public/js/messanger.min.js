$(function(){getmessages=function(){$.ajax("/messenger_result",{type:"post",success:function(a){$(".chat_middel").html(a);if(autoscroll){scrolldwon()}$(".chat_middel").on("scroll",function(){if($(this).scrollTop()<this.scrollHeight-$(this).height()){autoscroll=false}else{autoscroll=true}})}})};autoscroll=true;scrolldwon=function(){$(".chat_middel").scrollTop($(".chat_middel")[0].scrollHeight)};getmessages();$timer=setInterval(getmessages,3000);$(document).on("submit","#messageForm",function(b){b.preventDefault();var a=new FormData($(this)[0]);a.append("file",$("#file")[0].files[0]);$.ajax("/sendMsg",{type:"post",data:a,success:function(){getmessages();$("#text").val("");$("#file").val(null)},cache:false,contentType:false,processData:false});autoscroll=true;scrolldwon=function(){$(".chat_middel").scrollTop($(".chat_middel")[0].scrollHeight)}});$("#text").keypress(function(b){if(b.which==13){$("#messageForm").submit();b.preventDefault();var a=new FormData($(this)[0]);a.append("file",$("#file")[0].files[0]);$.ajax("/sendMsg_U",{type:"post",data:a,success:function(){getmessages();$("#text").val("");$("#file").val(null)},cache:false,contentType:false,processData:false});autoscroll=true;scrolldwon=function(){$(".chat_middel").scrollTop($(".chat_middel")[0].scrollHeight)}}})});